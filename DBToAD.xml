<actionDefs xmlns="urn:idauto.net:dss:actiondef"><actionDef changeCount="357" modifiedMs="1580764640533" modifiedBy="0f8e30d0-79b0-11e5-be1a-0e2f76cfa64f" modifiedByName="Administrator" name="DBToAD" category="" builtIn="false" community="false" returnsValue="true" description="Template containing recommended structure for solutions that sync data from a database table/view to Active Directory."><argDefs><argDef optional="true" type="enum:EmpID,Department" name="key_field"/><argDef optional="true" type="string" name="key_value"/><argDef type="enum:true,false" name="log_only"/></argDefs><actions><action id="52dd6672-aa07-4a98-b680-a476e9798ebe" name="comment"><arg name="comment" value="System Variables"/></action><action id="B45B331A-1F43-4B83-990B-A4F7F41FF46F" name="section"><arg name="do"><action id="cfa38eb2-da5a-4f0d-9ce5-6555a1baa4a0" name="Globals"/></arg></action><action id="5feeda3d-3872-4155-a154-4108bc50c175" name="comment"><arg name="comment" value="Open Connections"/></action><action id="a476818c-f4a7-4423-bb34-b7de766530d9" name="section"><arg name="do"><action id="ff0f8381-c1fe-4a0f-a2b9-1856c0b5535a" name="openDatabaseConnection" outputVar="sessionDB"><arg name="jdbcDriverClass" value="Global.dbDriverClass"/><arg name="jdbcURL" value="Global.dbConnString"/><arg name="user" value="Global.dbUser"/><arg name="password" value="Global.dbPwd"/></action><action id="1fd4060c-2159-4a0c-8390-6303f45c9ce8" name="openADConnection" outputVar="sessionAD"><arg name="adHost" value="Global.adHost"/><arg name="adPort" value="Global.adPort"/><arg name="useSSL" value="Global.adSSL"/><arg name="userDn" value="Global.adUser"/><arg name="password" value="Global.adPwd"/></action><action id="49991123-7cca-4c93-bde6-4904db92812f" name="if"><arg name="condition" value="!sessionDB || !sessionAD"/><arg name="then"><action id="cbfc3f91-ebac-44ec-b4b6-cfc67a8efa3d" name="comment"><arg name="comment" value="--- Error making connections.  Terminating process."/></action><action id="df1167b8-48c1-4581-89ba-8f7cf83bf02a" name="return"/></arg></action></arg></action><action id="dfb76f61-79a8-4089-b935-456bbf94c696" name="comment"><arg name="comment" value="Local Variables"/></action><action id="c391efa7-652d-4664-8138-a88379b53571" name="section"><arg name="do"><action id="829878FF-A6CD-20A1-CBE5-C0D2CEE0E3A2" name="setVariable"><arg name="name" value="varCurrentTime"/><arg name="value" value="now()"/></action><action id="79986734-752F-E6E9-2197-C0D2CEF1C02C" name="formatDate" outputVar="varCurrentDate"><arg name="date" value="varCurrentTime"/><arg name="pattern" value="&quot;yyyyMMdd&quot;"/></action><action id="CC2FFB99-6434-AFCA-9B3D-C0E5FDEF9F21" name="setVariable"><arg name="name" value="varCurrentDate"/><arg name="value" value="varCurrentDate+&quot;000000.0Z&quot;"/></action><action id="1e587ccf-fb2c-4ecd-8400-f4337ef9017d" name="setVariable"><arg name="name" value="total"/><arg name="value" value="0"/></action><action id="80a7c4a2-e292-4f81-b760-2d13713d3966" name="setVariable"><arg name="name" value="totalAdd"/><arg name="value" value="0"/></action><action id="f89146f3-72ce-4781-950e-65a4fe84ce48" name="setVariable"><arg name="name" value="totalUpdate"/><arg name="value" value="0"/></action><action id="ea137e12-3a69-48e8-8564-bcaa36b90f5d" name="setVariable"><arg name="name" value="totalEnable"/><arg name="value" value="0"/></action><action id="94e49510-30fe-4290-80c8-7ca9c302d32e" name="setVariable"><arg name="name" value="totalDisable"/><arg name="value" value="0"/></action><action id="b4bad7bd-1f9d-4d09-9f75-6054132be8d8" name="setVariable"><arg name="name" value="totalMove"/><arg name="value" value="0"/></action></arg></action><action id="1d9ed85a-57de-4440-9c60-8c3b83f3691b" name="comment"><arg name="comment" value="Query"/></action><action id="b8bcfb3d-8dc7-438d-8bb3-83c7a116ec37" name="section"><arg name="do"><action id="cdb5e60e-c8be-476f-b16a-6c399353e395" name="if"><arg name="condition" value="key_field &amp;&amp; key_value"/><arg name="then"><action id="e915e11d-6331-449c-b2d1-13d72215bf63" name="queryDatabaseSQL" outputVar="records"><arg name="dbConnection" value="sessionDB"/><arg name="sql" value="&quot;SELECT * FROM employees WHERE &quot;+key_field+&quot;=?&quot;"/><arg name="params" value="[key_value]"/></action></arg><arg name="else"><action id="35b43073-11a6-406d-a278-5958dc5676ce" name="queryDatabaseSQL" outputVar="records"><arg name="dbConnection" value="sessionDB"/><arg name="sql" value="&quot;SELECT * FROM employees&quot;"/></action></arg></action></arg></action><action id="8c26414a-b159-48cb-9b13-40d9c0da2aaa" name="comment"><arg name="comment" value="Iterate Records"/></action><action id="EF4EF3FB-BD75-0BDB-0348-8B14B467A642" name="section"><arg name="do"><action id="7f9aca61-c822-4e45-aa5e-594f66d51675" name="forEach"><arg name="variable" value="record"/><arg name="collection" value="records"/><arg name="do"><action id="d5506724-8440-43ba-b40e-d657cf1204d9" name="comment"><arg name="comment" value="Transformations"/></action><action id="3547D94E-67CE-237C-C22E-A4FACC67EC71" name="section"><arg name="do"><action id="3dc8bc2e-69d1-4459-9d42-1a78887f2110" name="setVariable"><arg name="name" value="total"/><arg name="value" value="total + 1"/></action><action id="1000bcb1-1427-4012-8d34-b95104d8b958" name="comment"><arg name="comment" value="---  Prepare record for AD"/></action><action id="7f0ac4c5-f68c-43f0-8954-535fef2b1b17" name="section"><arg name="do"><action id="c252cc85-954b-467c-bb6c-89180d142689" name="renameRecordFields"><arg name="record" value="record"/><arg name="oldFields" value="&quot;id,fname,sname,position,department,location,supervisor,status&quot;"/><arg name="newFields" value="&quot;employeeID,givenName,sn,title,department,physicalDeliveryOfficeName,idautoPersonManagerID,idautoStatus&quot;"/></action><action id="55af94d9-3ecb-4b05-ab13-12e773da2d73" name="filterRecordFields"><arg name="record" value="record"/><arg name="fields" value="&quot;employeeID,givenName,sn,title,department,physicalDeliveryOfficeName,idautoPersonManagerID,idautoStatus&quot;"/></action></arg></action><action id="5c88c6ce-3d6e-4245-a1b9-e8222f49f5a8" name="comment"><arg name="comment" value="--- Determine placement context"/></action><action id="6078d63a-d4aa-430e-bb48-41c645833032" name="section"><arg name="do"><action id="a600ea59-5919-40d2-9523-64f16d72d91f" name="if"><arg name="condition" value="record['departmentNumber']"/><arg name="then"><action id="7e6c5261-e158-48b6-9873-38765afcef7b" name="getADRecords" outputVar="recordsOrgUnit"><arg name="adConnection" value="sessionAD"/><arg name="baseDn" value="Global.adBaseDN"/><arg name="scope" value="&quot;sub&quot;"/><arg name="filter" value="&quot;(&amp;(objectClass=organizationalUnit)(businessCategory=&quot;+record['departmentNumber']+&quot;))&quot;"/></action><action id="37af2747-7d7e-4610-a313-2d1848a2b97e" name="if"><arg name="condition" value="recordsOrgUnit &amp;&amp; recordsOrgUnit.length == 1"/><arg name="then"><action id="71a0c7e8-8683-405a-95c5-8711be324cf5" name="setVariable"><arg name="name" value="newContext"/><arg name="value" value="recordsOrgUnit[0]['@dn']"/></action></arg><arg name="else"><action id="22011a1d-ade9-4047-a9a1-590d1119ece1" name="comment"><arg name="comment" value="--- No OU found. Set to exception DN."/></action><action id="52ceeccc-bc95-48f2-9e28-678a2ad720de" name="setVariable"><arg name="name" value="newContext"/><arg name="value" value="Global.adExceptionDN"/></action></arg></action></arg><arg name="else"><action id="8978132c-7423-449a-850a-9e9581e491c8" name="comment"><arg name="comment" value="--- No user placement attribute found. Set to exception DN."/></action><action id="67289f80-258e-4a8c-a13f-c2370308c8c1" name="setVariable"><arg name="name" value="newContext"/><arg name="value" value="Global.adExceptionDN"/></action></arg></action></arg></action><action id="98083128-10c0-4af8-9784-c66d951009ee" name="comment"><arg name="comment" value="---  Assign default values"/></action><action id="88bb25e7-cc30-4037-bcac-8004d85b2f67" name="section"><arg name="do"><action id="29b42812-222e-46cf-8c48-7fe8b41d2ea0" name="setRecordFieldValue"><arg name="record" value="record"/><arg name="field" value="&quot;employeeType&quot;"/><arg name="value" value="&quot;Staff&quot;"/></action></arg></action></arg></action><action id="f21a470b-b1f0-403d-adf6-76ae288b7f67" name="comment"><arg name="comment" value="Match"/></action><action id="7cfd74e8-d656-4894-bb25-a0e96ccc594f" name="section"><arg name="do"><action id="5606d7eb-6c35-4287-8b91-ce1d53347e25" name="getADRecords" outputVar="exists"><arg name="adConnection" value="sessionAD"/><arg name="baseDn" value="Global.adBaseDN"/><arg name="scope" value="&quot;sub&quot;"/><arg name="filter" value="&quot;(employeeID=&quot; +record['employeeID']+ &quot;)&quot;"/><arg name="attributes" value="&quot;*&quot;"/></action></arg></action><action id="3E600274-E55F-000D-DD49-8B14FA96AA9E" name="comment"><arg name="comment" value="Operations"/></action><action id="B81213A3-83DF-9670-BD9D-8B1510613337" name="section"><arg name="do"><action id="2ee6b3da-b6e0-4aa9-927a-e01bfdd4b5e5" name="if"><arg name="condition" value="exists &amp;&amp; exists.length == 0"/><arg name="then"><action id="65b6addc-04bc-462e-ab03-c677a3b1a54a" name="comment"><arg name="comment" value="Add"/></action><action id="7FFBC9CD-5A67-10AF-FDB6-A4FBFCAF5862" name="section"><arg name="do"><action id="5543ba75-037d-40fe-9b83-64c692e3a9fe" name="comment"><arg name="comment" value="---  Validate record meets requirements for creation"/></action><action id="db9f2dfc-d4bf-4ab0-b68d-122c16d90b52" name="section"><arg name="do"><action id="cf0a2f22-78ca-44be-9688-52a0e4c7760f" name="if"><arg name="condition" value="!record['employeeID'] || record['idautoStatus'] != &quot;A&quot;"/><arg name="then"><action id="8187df29-be29-4d7f-b1df-5b1e45d13962" name="continue"/></arg></action></arg></action><action id="627a8b46-4254-4b43-8d62-8d3fe38fbd00" name="comment"><arg name="comment" value="---  Assign context and usernames"/></action><action id="605431c5-1ef2-4ce4-b2b5-9450144bc4b4" name="section"><arg name="do"><action id="8776f090-d099-4362-8289-2eb3983e0e5b" name="GenerateUsername" outputVar="username"><arg name="session" value="sessionAD"/><arg name="record" value="record"/></action><action id="E83F2008-4D5A-4A08-8C0A-1F7AF91B354A" name="stringToLower" outputVar="username"><arg name="string" value="username"/></action><action id="a664e0c9-1381-4985-a428-a303dccc86fd" name="setRecordFieldValue"><arg name="record" value="record"/><arg name="field" value="&quot;@dn&quot;"/><arg name="value" value="&quot;cn=&quot;+username+&quot;,&quot;+newContext"/></action><action id="34d5327c-ebda-4ca8-a0bb-6b1a46212eb5" name="setRecordFieldValue"><arg name="record" value="record"/><arg name="field" value="&quot;sAMAccountName&quot;"/><arg name="value" value="username"/></action><action id="ec6f4a6f-0f04-4177-a377-29cdfae1a6bd" name="setRecordFieldValue"><arg name="record" value="record"/><arg name="field" value="&quot;userPrincipalName&quot;"/><arg name="value" value="username+&quot;@&quot;+Global.adDNSDomain"/></action></arg></action><action id="afa96b72-559e-475e-83ac-52b480d8a9fd" name="comment"><arg name="comment" value="---  Assign default add values"/></action><action id="3c8fc8cc-8d07-4b10-88e6-f2ea832ae3d4" name="section"><arg name="do"><action id="0dea75cc-4bf5-4263-b8db-88a219260570" name="setRecordFieldValue"><arg name="record" value="record"/><arg name="field" value="&quot;objectClass&quot;"/><arg name="value" value="&quot;User&quot;"/></action><action id="10c8c3e8-d0a0-42f1-aeb9-ff1de607ad6d" name="setRecordFieldValue"><arg name="record" value="record"/><arg name="field" value="&quot;mail&quot;"/><arg name="value" value="username+&quot;@&quot;+Global.adDNSDomain"/></action><action id="21048DEB-91DC-19A7-BEE9-74DE33C8AA91" name="setRecordFieldValue"><arg name="record" value="record"/><arg name="field" value="&quot;idautoID&quot;"/><arg name="value" value="java.util.UUID.randomUUID().toString()"/></action></arg></action><action id="95b8cd53-0457-440e-88e4-5ff48c13b1ee" name="comment"><arg name="comment" value="---  Assign initial password value"/></action><action id="1a56d698-25b6-4cee-9fc5-dea14b458378" name="section"><arg name="do"><action id="250474b6-2a15-4e28-b8c1-0f1f1b305be0" name="setVariable"><arg name="name" value="password"/><arg name="value" value="&quot;Ch@ngeM3&quot;"/></action></arg></action><action id="e13e5412-5da4-4728-80fc-d79bf053d7eb" name="comment"><arg name="comment" value="---  Attempt to create user object."/></action><action id="3b2c4c3e-4132-40bc-a119-29ce20edfb19" name="section"><arg name="do"><action id="6161c29a-f13f-44ca-98f6-cecfccd3ca3b" name="if"><arg name="condition" value="log_only == &quot;true&quot;"/><arg name="then"><action id="7f8e5a6f-e39a-4c1b-bc46-4280267809e3" name="log"><arg name="message" value="&quot;ADD: &quot;+record"/><arg name="color" value="&quot;black&quot;"/></action><action id="F4E7265B-3D8B-4645-276F-0433E13C56BB" name="setVariable"><arg name="name" value="totalAdd"/><arg name="value" value="totalAdd + 1"/></action></arg><arg name="else"><action id="a2b81fa6-d393-4cbe-9c52-3c5f74361dc2" name="addADUser" outputVar="result"><arg name="adConnection" value="sessionAD"/><arg name="record" value="record"/><arg name="password" value="password"/></action><action id="8c1f2b0c-8210-42d2-b5e6-be0924a14be1" name="if"><arg name="condition" value="result"/><arg name="then"><action id="2881c348-2ca2-41ca-8089-915999287ca8" name="setVariable"><arg name="name" value="auditExtProperties"/><arg name="value" value="{&quot;record&quot;:record}"/></action><action id="06f63249-3eff-4882-a1e8-2415ceea4cb3" name="logAuditEvent"><arg name="eventName" value="&quot;createAccount&quot;"/><arg name="targetSystem" value="&quot;Active Directory&quot;"/><arg name="targetID" value="record['idautoID']"/><arg name="target" value="record['@dn']"/><arg name="successful" value="true"/><arg name="extendedProperties" value="auditExtProperties"/></action><action id="c8843a39-d432-432a-8165-096877862b81" name="setVariable"><arg name="name" value="totalAdd"/><arg name="value" value="totalAdd + 1"/></action></arg><arg name="else"><action id="9569176e-3844-4a17-aa92-8311d750b56c" name="log"><arg name="message" value="&quot;ADD: &quot;+record"/><arg name="color" value="&quot;red&quot;"/></action><action id="e7e9e7c4-d4be-4b3e-9001-7c0ec9d1cf59" name="setVariable"><arg name="name" value="auditExtProperties"/><arg name="value" value="{&quot;record&quot;:record}"/></action><action id="a901b81b-4075-420d-a285-250fae4707be" name="logAuditEvent"><arg name="eventName" value="&quot;createAccount&quot;"/><arg name="targetSystem" value="&quot;Active Directory&quot;"/><arg name="targetID" value="record['idautoID']"/><arg name="target" value="record['@dn']"/><arg name="successful" value="false"/><arg name="extendedProperties" value="auditExtProperties"/></action></arg></action></arg></action></arg></action></arg></action></arg><arg name="else"><action id="219affdb-47f7-4385-93a7-1373bd3859fb" name="comment"><arg name="comment" value="Update"/></action><action id="39940B9C-275B-29B6-8091-A4FC68EE6459" name="section"><arg name="label" value="Update"/><arg name="do"><action id="169c7302-5ebb-4187-a4a0-8fe2962b5077" name="comment"><arg name="comment" value="---  Skip if record hasn't changed"/></action><action id="73477673-126f-4ffa-8095-7580b7c42cff" name="section"><arg name="do"><action id="733352a7-286b-4ec7-b86d-bbbb82066eeb" name="HasRecordChanged" outputVar="recordHasChanged"><arg name="new_record" value="record"/><arg name="old_record" value="exists[0]"/></action><action id="1c0213dd-7254-4886-bb3b-217b1db4dddd" name="if"><arg name="condition" value="!recordHasChanged"/><arg name="then"><action id="F27EE5E7-30FA-3EA8-5037-2E4E33EB872F" name="break"><arg name="label" value="Update"/></action></arg></action></arg></action><action id="371a6050-e028-4593-b282-72864554a7e5" name="comment"><arg name="comment" value="---  Set default values"/></action><action id="41511cda-a6ef-4e81-aab7-3d67a2c4c9d8" name="section"><arg name="do"><action id="e3d14caf-be62-469b-a7ba-c28550a0be9d" name="setRecordFieldValue"><arg name="record" value="record"/><arg name="field" value="&quot;@dn&quot;"/><arg name="value" value="exists[0]['@dn']"/></action></arg></action><action id="bac2ba45-869e-4390-9101-dcb902779ecc" name="comment"><arg name="comment" value="---  Perform actions based on status change"/></action><action id="7482664e-b24d-4f2d-aaea-fa02a86a6fdd" name="section"><arg name="do"><action id="2ce768c4-a2d3-4600-a800-4b9466f25a05" name="if"><arg name="condition" value="record['idautoStatus'] != exists[0]['idautoStatus']"/><arg name="then"><action id="3d078319-27f0-4558-8ba4-7ee3b76af7de" name="if"><arg name="condition" value="record['idautoStatus'] == &quot;A&quot;"/><arg name="then"><action id="74721A5F-66A8-457D-F6AE-C0E7ABDAC73B" name="comment"><arg name="comment" value="---  Remove deprovision date"/></action><action id="5DC6B91F-112C-408A-B635-C0E7DC91D34E" name="section"><arg name="do"><action id="A28B1FA4-D89F-A0F3-1E93-C0E7F49CD7E6" name="setRecordFieldValue"><arg name="record" value="record"/><arg name="field" value="&quot;idautoPersonEndDate&quot;"/><arg name="value" value="null"/></action></arg></action><action id="6de13e09-859d-49a0-8297-e52caacf77a4" name="if"><arg name="condition" value="log_only == &quot;true&quot;"/><arg name="then"><action id="0209915c-ef51-4534-9b6f-b36df0b09efc" name="log"><arg name="message" value="&quot;ENABLE: &quot;+record['@dn']"/><arg name="color" value="&quot;black&quot;"/></action><action id="FF1CFD8E-DFE0-5649-F998-043407640ACB" name="setVariable"><arg name="name" value="totalEnable"/><arg name="value" value="totalEnable + 1"/></action></arg><arg name="else"><action id="def43414-f60c-45b5-b6eb-1caddf663006" name="setADAccountDisabled" outputVar="result"><arg name="adConnection" value="sessionAD"/><arg name="accountDn" value="record['@dn']"/><arg name="state" value="false"/></action><action id="bc8527cd-f4ef-4d91-a99d-967fc77d10ee" name="if"><arg name="condition" value="result"/><arg name="then"><action id="e212047d-5361-49da-88f8-649f17771342" name="logAuditEvent"><arg name="eventName" value="&quot;enableAccount&quot;"/><arg name="targetSystem" value="&quot;Active Directory&quot;"/><arg name="targetID" value="exists[0]['idautoID']"/><arg name="target" value="record['@dn']"/><arg name="successful" value="true"/></action><action id="f8fef9e3-e643-40ac-921e-0a17c6ed65fe" name="setVariable"><arg name="name" value="totalEnable"/><arg name="value" value="totalEnable + 1"/></action></arg><arg name="else"><action id="2c057ec8-6fc3-4535-b179-e6952d71ddd3" name="log"><arg name="message" value="&quot;ENABLE: &quot;+record['@dn']"/><arg name="color" value="&quot;red&quot;"/></action><action id="2a248c39-051f-4d7c-b739-55cd1167814c" name="logAuditEvent"><arg name="eventName" value="&quot;enableAccount&quot;"/><arg name="targetSystem" value="&quot;Active Directory&quot;"/><arg name="targetID" value="exists[0]['idautoID']"/><arg name="target" value="record['@dn']"/><arg name="successful" value="false"/></action></arg></action></arg></action></arg><arg name="else"><action id="7364D5FC-D40A-1907-28EE-C0E950B1F7A0" name="comment"><arg name="comment" value="---  Set deprovision date"/></action><action id="3890773E-D396-F44F-B4F9-C0E950C03076" name="section"><arg name="do"><action id="CB9EA461-9C1E-3D56-D639-C0E950C09ED2" name="setRecordFieldValue"><arg name="record" value="record"/><arg name="field" value="&quot;idautoPersonEndDate&quot;"/><arg name="value" value="varCurrentDate"/></action></arg></action><action id="bf6e8375-6ae7-47a7-9b14-f787c3a059b5" name="if"><arg name="condition" value="log_only == &quot;true&quot;"/><arg name="then"><action id="39558bfd-2cbb-443c-bc8b-d599cfd5cc3a" name="log"><arg name="message" value="&quot;DISABLE: &quot;+record['@dn']"/><arg name="color" value="&quot;black&quot;"/></action><action id="FECEB93C-CE7B-A7FB-7C7C-04342EB67404" name="setVariable"><arg name="name" value="totalDisable"/><arg name="value" value="totalDisable + 1"/></action></arg><arg name="else"><action id="8421b691-2da1-4ee2-8856-590985ae6c37" name="setADAccountDisabled" outputVar="result"><arg name="adConnection" value="sessionAD"/><arg name="accountDn" value="record['@dn']"/><arg name="state" value="true"/></action><action id="18512aad-ecc0-472a-a0fb-ce8bd55dad4e" name="if"><arg name="condition" value="result"/><arg name="then"><action id="616a4431-feeb-4ffe-a06e-e0dcfe8a88ce" name="logAuditEvent"><arg name="eventName" value="&quot;disableAccount&quot;"/><arg name="targetSystem" value="&quot;Active Directory&quot;"/><arg name="targetID" value="exists[0]['idautoID']"/><arg name="target" value="record['@dn']"/><arg name="successful" value="true"/></action><action id="bd2dd714-a734-4f0e-9c90-2a8f24c98b5a" name="setVariable"><arg name="name" value="totalDisable"/><arg name="value" value="totalDisable + 1"/></action></arg><arg name="else"><action id="255f66fc-f627-40c9-8f32-11c7104c1e30" name="log"><arg name="message" value="&quot;DISABLE: &quot;+record['@dn']"/><arg name="color" value="&quot;red&quot;"/></action><action id="091c60a2-39ad-4bf5-b687-7663d132d1c5" name="logAuditEvent"><arg name="eventName" value="&quot;disableAccount&quot;"/><arg name="targetSystem" value="&quot;Active Directory&quot;"/><arg name="targetID" value="exists[0]['idautoID']"/><arg name="target" value="record['@dn']"/><arg name="successful" value="false"/></action></arg></action></arg></action></arg></action></arg></action></arg></action><action id="65a75fc6-3303-418f-add9-036ee88c66e9" name="comment"><arg name="comment" value="---  Attempt to save object"/></action><action id="d42eccd9-3ee1-48b9-9891-7b9dac095da9" name="section"><arg name="do"><action id="2ac93809-c096-46fb-9456-ba253d3584d4" name="if"><arg name="condition" value="log_only == &quot;true&quot;"/><arg name="then"><action id="52976e5e-f8e6-45d1-894d-a37bb8113252" name="log"><arg name="message" value="&quot;UPDATE: &quot;+record"/><arg name="color" value="&quot;black&quot;"/></action><action id="7A848F57-B9D9-A844-C4F8-04344DDFC1E2" name="setVariable"><arg name="name" value="totalUpdate"/><arg name="value" value="totalUpdate + 1"/></action></arg><arg name="else"><action id="ff313dd6-8281-44e0-9ac9-fa9fdece621f" name="saveADRecord" outputVar="result"><arg name="adConnection" value="sessionAD"/><arg name="record" value="record"/></action><action id="5323bc21-6e85-45fd-afee-efc5ea20642a" name="if"><arg name="condition" value="result"/><arg name="then"><action id="a90d33ae-b749-4138-a32d-b853096f94a4" name="setVariable"><arg name="name" value="auditExtProperties"/><arg name="value" value="{&quot;record&quot;:record}"/></action><action id="48003c43-5516-449d-a4d6-e2b3930cf917" name="logAuditEvent"><arg name="eventName" value="&quot;updateAccount&quot;"/><arg name="targetSystem" value="&quot;Active Directory&quot;"/><arg name="targetID" value="exists[0]['idautoID']"/><arg name="target" value="record['@dn']"/><arg name="successful" value="true"/><arg name="extendedProperties" value="auditExtProperties"/></action><action id="fa007810-8459-44d1-9acf-8d0fdfa2af03" name="setVariable"><arg name="name" value="totalUpdate"/><arg name="value" value="totalUpdate + 1"/></action></arg><arg name="else"><action id="ab8f54d4-34c8-4267-a938-283a24db4f1d" name="log"><arg name="message" value="&quot;UPDATE: &quot;+record"/><arg name="color" value="&quot;red&quot;"/></action><action id="aa9ad025-d2c1-489b-b56a-7eb05f496313" name="setVariable"><arg name="name" value="auditExtProperties"/><arg name="value" value="{&quot;record&quot;:record}"/></action><action id="16c64278-4f05-408a-a271-d3ba425d7a75" name="logAuditEvent"><arg name="eventName" value="&quot;updateAccount&quot;"/><arg name="targetSystem" value="&quot;Active Directory&quot;"/><arg name="targetID" value="exists[0]['idautoID']"/><arg name="target" value="record['@dn']"/><arg name="successful" value="false"/><arg name="extendedProperties" value="auditExtProperties"/></action></arg></action></arg></action></arg></action></arg></action><action id="2FF29443-E722-4033-6080-2E4E7D777190" name="comment"><arg name="comment" value="Move"/></action><action id="E25E5390-45AB-F6F6-8057-2E4E7DA4081E" name="section"><arg name="do"><action id="24359FEC-37AE-3007-9F89-2E4E7DA4BEBD" name="setVariable"><arg name="name" value="currentDN"/><arg name="value" value="exists[0]['@dn']"/></action><action id="60069A4A-D5FB-2FC5-3F27-2E4E7DA4F6CB" name="setVariable"><arg name="name" value="newDN"/><arg name="value" value="&quot;CN=&quot;+exists[0]['sAMAccountName']+&quot;,&quot;+newContext"/></action><action id="81172E0D-1B7B-3F92-3DC2-2E4E7DA56F85" name="if"><arg name="condition" value="currentDN.toLowerCase() != newDN.toLowerCase()"/><arg name="then"><action id="EEC6EB75-3320-E449-B7FA-2E4E7DA5DDE8" name="if"><arg name="condition" value="log_only == &quot;true&quot;"/><arg name="then"><action id="71CD2EC7-FD61-CA1C-B9E1-2E4E7DA566A7" name="log"><arg name="message" value="&quot;MOVE:  &quot;+newDN"/><arg name="color" value="&quot;black&quot;"/></action><action id="88E0B368-8DEC-96D3-51EF-043465C599AA" name="setVariable"><arg name="name" value="totalMove"/><arg name="value" value="totalMove + 1"/></action></arg><arg name="else"><action id="2810614E-0B91-0CE0-3197-2E4E7DA691B7" name="renameADRecord" outputVar="result"><arg name="adConnection" value="sessionAD"/><arg name="oldDn" value="currentDN"/><arg name="newDn" value="newDN"/><arg name="keepOldRdn" value="false"/></action><action id="548FBBDB-6299-0DB2-D0C2-2E4E7DA784AD" name="if"><arg name="condition" value="result"/><arg name="then"><action id="AF89DE40-8E6B-8B44-C441-2E4E7DA7276D" name="setVariable"><arg name="name" value="auditExtProperties"/><arg name="value" value="{&quot;dest_dn&quot;:newDN}"/></action><action id="EA70EDE7-A209-FE33-2A17-2E4E7DA8B8D5" name="logAuditEvent"><arg name="eventName" value="&quot;moveAccount&quot;"/><arg name="targetSystem" value="&quot;Active Directory&quot;"/><arg name="targetID" value="exists[0]['idautoID']"/><arg name="target" value="currentDN"/><arg name="successful" value="true"/><arg name="extendedProperties" value="auditExtProperties"/></action><action id="31B78486-AECE-34BF-A9FE-2E4E7DA9388C" name="setVariable"><arg name="name" value="totalMove"/><arg name="value" value="totalMove + 1"/></action></arg><arg name="else"><action id="77919DC0-C23B-4650-1BF8-2E4E7DAAC918" name="log"><arg name="message" value="&quot;MOVE:  &quot;+newDN"/><arg name="color" value="&quot;red&quot;"/></action><action id="8096D1A4-F5F3-FDFE-95FE-2E4E7DAB9F6B" name="setVariable"><arg name="name" value="auditExtProperties"/><arg name="value" value="{&quot;dest_dn&quot;:newDN}"/></action><action id="C6AB1E91-267C-42EB-2E74-2E4E7DAB25CE" name="logAuditEvent"><arg name="eventName" value="&quot;moveAccount&quot;"/><arg name="targetSystem" value="&quot;Active Directory&quot;"/><arg name="targetID" value="exists[0]['idautoID']"/><arg name="target" value="currentDN"/><arg name="successful" value="false"/><arg name="extendedProperties" value="auditExtProperties"/></action></arg></action></arg></action></arg></action></arg></action></arg></action></arg></action></arg></action></arg></action><action id="863a1bc2-0c60-400f-87c5-4b01eff6e479" name="comment"><arg name="comment" value="Close Connections"/></action><action id="861f13d8-06c9-411a-8e7c-24ec3b3af4dd" name="section"><arg name="do"><action id="2ca565fe-d95b-4059-b3fe-7739190496d1" name="close"><arg name="closeable" value="sessionAD"/></action><action id="2fc89504-5dee-4c7b-ba9d-4db2a88bda46" name="close"><arg name="closeable" value="sessionDB"/></action></arg></action><action id="a09ef21f-5bf2-4c68-bbcd-7cf20f9460b6" name="comment"><arg name="comment" value="Tally Results"/></action><action id="653dc6a9-6a22-4d2d-8bd9-2909b051197c" name="section"><arg name="do"><action id="b4790bb0-49e6-4b6f-b9c4-5e65f290f1bd" name="log"><arg name="message" value="&quot;=========================================================&quot;"/><arg name="color" value="&quot;purple&quot;"/></action><action id="11f0a503-4203-4d31-bfde-a3a565535e54" name="log"><arg name="message" value="&quot;Processing Statistics&quot;"/><arg name="color" value="&quot;purple&quot;"/></action><action id="5d61963c-dd0b-494c-a36b-31e920df8e4b" name="log"><arg name="message" value="&quot;=========================================================&quot;"/><arg name="color" value="&quot;purple&quot;"/></action><action id="59414177-8e54-4c4e-a57f-d4de58b490b8" name="log"><arg name="message" value="&quot;Total Processed: &quot;+total"/><arg name="color" value="&quot;green&quot;"/></action><action id="0a3c66c5-1e2d-4909-953b-d98b041ab8ce" name="log"><arg name="message" value="&quot;Added: &quot;+totalAdd"/><arg name="color" value="&quot;green&quot;"/></action><action id="8679d826-6f01-4ac5-86e4-e5cea2e57e69" name="log"><arg name="message" value="&quot;Updated: &quot;+totalUpdate"/><arg name="color" value="&quot;green&quot;"/></action><action id="0f48327c-0d93-421d-884b-0020eb30ccf4" name="log"><arg name="message" value="&quot;Enabled: &quot;+totalEnable"/><arg name="color" value="&quot;green&quot;"/></action><action id="0c0b0e86-c2e9-44bb-afc9-e845c73ebbeb" name="log"><arg name="message" value="&quot;Disabled: &quot;+totalDisable"/><arg name="color" value="&quot;green&quot;"/></action><action id="0c1ff72f-2673-4a00-8440-53b728a3fd78" name="log"><arg name="message" value="&quot;Moved: &quot;+totalMove"/><arg name="color" value="&quot;green&quot;"/></action></arg></action></actions></actionDef></actionDefs>